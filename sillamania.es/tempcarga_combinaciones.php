<?php
define( 'WP_USE_THEMES',false );
require_once( './wp-load.php' );

$mydb2 = new wpdb('sillamania0','Ofiprix2018','sillamaniaes_dos','localhost');
$mydb = new wpdb('dicorops2','Dicoroweb2011','dicorops2','localhost');

/*
$que="SELECT `id_product`,0 as combi, reference FROM `ps_product` WHERE `reference`!='' UNION SELECT `id_product`,`id_product_attribute`,`reference` FROM `ps_product_attribute` WHERE `reference`!=''";
	$query = $mydb2->get_results( $que, OBJECT );
print_r($query);
*/

//echo "1";

//$references[]='00064001010000';
$references = array();


array_push($references,00026100000000);
array_push($references,00026100000001);
array_push($references,00026100000002);
array_push($references,00026100000003);
array_push($references,00026100000004);
array_push($references,00026100000114);
array_push($references,00026100000005);
array_push($references,00026100000006);
array_push($references,00026100000007);
array_push($references,00026100000008);
array_push($references,00026000000652);
array_push($references,00026100000009);
array_push($references,00026100000010);
array_push($references,00026100000011);
array_push($references,00026100000012);
array_push($references,00026100000013);
array_push($references,00026100000014);
array_push($references,00026000000555);
array_push($references,00026000000554);
array_push($references,00026000000557);
array_push($references,00026000000556);
array_push($references,00026000000551);
array_push($references,00026000000550);
array_push($references,00026000000553);
array_push($references,00026000000552);
array_push($references,00026100000018);
array_push($references,00026100000019);
array_push($references,00026100000020);
array_push($references,00026100000021);
array_push($references,00026100000022);
array_push($references,00026100000023);
array_push($references,00026100000024);
array_push($references,00026000000589);
array_push($references,00026000000590);
array_push($references,00026100000025);
array_push($references,00026100000026);
array_push($references,00026100000027);
array_push($references,00026100000028);
array_push($references,00026100000029);
array_push($references,00026100000030);
array_push($references,00026100000031);
array_push($references,00026100000032);
array_push($references,00026100000033);
array_push($references,00026000000592);
array_push($references,00026000000598);
array_push($references,00026100000034);
array_push($references,00026000000663);
array_push($references,00026000000597);
array_push($references,00026000000591);
array_push($references,00026000000596);
array_push($references,00026000000593);
array_push($references,00026000000594);
array_push($references,00026000000595);
array_push($references,00026000000599);
array_push($references,00026000000610);
array_push($references,00026000000609);
array_push($references,00026000000607);
array_push($references,00026000000608);
array_push($references,00026000000664);
array_push($references,00026000000611);
array_push($references,00026000000617);
array_push($references,00026000000612);
array_push($references,00026000000613);
array_push($references,00026000000614);
array_push($references,00026000000615);
array_push($references,00026000000616);
array_push($references,00026000000660);
array_push($references,00026000000661);
array_push($references,00026000000662);
array_push($references,00026000000657);
array_push($references,00026000000658);
array_push($references,00026000000659);
array_push($references,00026100000035);
array_push($references,00026100000036);
array_push($references,00026100000037);
array_push($references,00026100000038);
array_push($references,00026100000039);
array_push($references,00026000000653);
array_push($references,00026000000654);
array_push($references,00026000000656);
array_push($references,00026000000655);
array_push($references,00026100000040);
array_push($references,00026100000041);
array_push($references,00026100000042);
array_push($references,00026100000043);
array_push($references,00026000000636);
array_push($references,00026100000044);
array_push($references,00026100000045);
array_push($references,00026100000046);
array_push($references,00026100000047);
array_push($references,00026100000048);
array_push($references,00026100000049);
array_push($references,00026100000050);
array_push($references,00026000000606);
array_push($references,00026000000603);
array_push($references,00026000000602);
array_push($references,00026000000600);
array_push($references,00026000000605);
array_push($references,00026000000604);
array_push($references,00026000000601);
array_push($references,00026100000051);
array_push($references,00026100000056);
array_push($references,00026000000649);
array_push($references,00026000000650);
array_push($references,00026000000651);
array_push($references,00026100000042);
array_push($references,00026100000057);
array_push($references,00026100000058);
array_push($references,00026100000059);
array_push($references,00026100000060);
array_push($references,00026100000061);
array_push($references,00026100000063);
array_push($references,00026100000064);
array_push($references,00026100000065);
array_push($references,00026100000066);
array_push($references,00026100000067);
array_push($references,00026100000068);
array_push($references,00026000000639);
array_push($references,00026000000640);
array_push($references,00026000000641);
array_push($references,00026000000642);
array_push($references,00026000000643);
array_push($references,00026000000582);
array_push($references,00026001000024);
array_push($references,00026001000025);
array_push($references,00026001000026);
array_push($references,00026000000583);
array_push($references,00026000000584);
array_push($references,00026000000585);
array_push($references,00026000000586);
array_push($references,00026000000587);
array_push($references,00026000000588);
array_push($references,00026000000644);
array_push($references,00026000000648);
array_push($references,00026100000069);
array_push($references,00026100000070);
array_push($references,00026100000071);
array_push($references,00026100000072);
array_push($references,00026000000646);
array_push($references,00026000000637);
array_push($references,00026000000638);
array_push($references,00026000000647);
array_push($references,00026000000618);
array_push($references,00026000000621);
array_push($references,00026000000624);
array_push($references,00026000000625);
array_push($references,00026000000626);
array_push($references,00026000000627);
array_push($references,00026000000619);
array_push($references,00026000000622);
array_push($references,00026000000628);
array_push($references,00026000000629);
array_push($references,00026000000630);
array_push($references,00026000000631);
array_push($references,00026000000620);
array_push($references,00026000000623);
array_push($references,00026000000632);
array_push($references,00026000000633);
array_push($references,00026000000634);
array_push($references,00026000000635);
array_push($references,00026000000669);
array_push($references,00026000000672);
array_push($references,00026000000668);
array_push($references,00026000000678);
array_push($references,00026000000667);
array_push($references,00026000000673);
array_push($references,00026000000680);
array_push($references,00026000000670);
array_push($references,00026000000676);
array_push($references,00026000000674);
array_push($references,00026000000681);
array_push($references,00026000000665);
array_push($references,00026000000566);
array_push($references,00026000000573);
array_push($references,00026000000567);
array_push($references,00026000000570);
array_push($references,00026000000569);
array_push($references,00026000000571);
array_push($references,00026000000568);
array_push($references,00026000000572);
array_push($references,00026000000558);
array_push($references,00026000000565);
array_push($references,00026000000559);
array_push($references,00026000000562);
array_push($references,00026000000561);
array_push($references,00026000000563);
array_push($references,00026000000560);
array_push($references,00026000000564);
array_push($references,00026000000683);
array_push($references,00026000000684);
array_push($references,00026000000688);
array_push($references,00026000000685);
array_push($references,00026000000686);
array_push($references,00026000000687);
array_push($references,00026000000525);
array_push($references,00026000000812);
array_push($references,00026000000526);
array_push($references,00026000000524);
array_push($references,00026000000527);
array_push($references,00026000000773);
array_push($references,00026000000780);
array_push($references,00026000000770);
array_push($references,00026000000777);
array_push($references,00026000000785);
array_push($references,00026000000782);
array_push($references,00026000000783);
array_push($references,00026000000769);
array_push($references,00026000000781);
array_push($references,00026000000779);
array_push($references,00026000000793);
array_push($references,00026000000797);
array_push($references,00026000000791);
array_push($references,00026000000795);
array_push($references,00026000000790);
array_push($references,00026000000796);
array_push($references,00026000000798);
array_push($references,00026000000799);
array_push($references,00026000000792);
array_push($references,00026000000794);
array_push($references,00026000000787);
array_push($references,00026000000774);
array_push($references,00026000000788);
array_push($references,00026000000768);
array_push($references,00026000000772);
array_push($references,00026000000671);
array_push($references,00026000000675);
array_push($references,00026000000677);
array_push($references,00026000000666);
array_push($references,00026000000679);
array_push($references,00026000000682);
array_push($references,00026000000574);
array_push($references,00026000000581);
array_push($references,00026000000575);
array_push($references,00026000000578);
array_push($references,00026000000577);
array_push($references,00026000000579);
array_push($references,00026000000576);
array_push($references,00026000000580);
array_push($references,00026000000776);
array_push($references,00026000000771);
array_push($references,00026000000775);
array_push($references,00026000000778);
array_push($references,00026000000784);
array_push($references,00026000000531);
array_push($references,00026000000530);
array_push($references,00026000000528);
array_push($references,00026000000529);
array_push($references,00026100000079);
array_push($references,00026100000080);
array_push($references,00026100000081);
array_push($references,00026100000082);
array_push($references,00026100000083);
array_push($references,00026100000084);
array_push($references,00026100000087);
array_push($references,00026000000645);
array_push($references,00026100000102);
array_push($references,00026100000109);
array_push($references,00026100000110);
array_push($references,00026100000111);
array_push($references,00026000000506);
array_push($references,00026000000508);
array_push($references,00026000000509);
array_push($references,00026000000511);
array_push($references,00026000000510);
array_push($references,00026000000507);
array_push($references,00026000000518);
array_push($references,00026000000519);
array_push($references,00026000000520);
array_push($references,00026001000051);
array_push($references,00026001000052);
array_push($references,00026001000053);
array_push($references,00026001000054);
array_push($references,00026001000055);
array_push($references,00026001000056);
array_push($references,00026001000057);
array_push($references,00026000000521);
array_push($references,00026000000522);
array_push($references,00026000000523);
array_push($references,00026001000022);
array_push($references,00026001000023);
array_push($references,00026001000027);
array_push($references,00026001000028);
array_push($references,00026001000029);
array_push($references,00026001000030);
array_push($references,00026001000031);
array_push($references,00026001000032);
array_push($references,00026001000033);
array_push($references,00026001000034);
array_push($references,00026001000035);
array_push($references,00026001000036);
array_push($references,00026001000037);
array_push($references,00026001000038);
array_push($references,00026001000039);
array_push($references,00026001000040);
array_push($references,00026001000041);
array_push($references,00026001000042);
array_push($references,00026001000043);
array_push($references,00026001000044);
array_push($references,00009001000009);
array_push($references,00009001000010);
array_push($references,00009001000011);
array_push($references,00026000000012);
array_push($references,00026000000011);
array_push($references,00026000000013);
array_push($references,00026000000032);
array_push($references,00026000000041);
array_push($references,00026000000072);
array_push($references,00008007000000);
array_push($references,00008007010001);
array_push($references,00008007080000);
array_push($references,00008001000033);
array_push($references,00008001000034);
array_push($references,00008001000014);
array_push($references,00008001000015);
array_push($references,00008001010000);
array_push($references,00008001000013);
array_push($references,00089001000000);
array_push($references,00089001000001);
array_push($references,00089001000002);
array_push($references,00089001000003);
array_push($references,00089001000004);
array_push($references,00089001000005);
array_push($references,00089002000000);
array_push($references,00089002000001);
array_push($references,00089002000002);
array_push($references,00089002000003);
array_push($references,00089002000004);
array_push($references,00089002000005);
array_push($references,00066001000006);
array_push($references,00066001000007);
array_push($references,00066006010001);
array_push($references,00026700000000);
array_push($references,00026700000001);
array_push($references,00026700000002);
array_push($references,00006008050000);
array_push($references,00006008060000);
array_push($references,00006008070000);
array_push($references,00006009050000);
array_push($references,00006009060000);
array_push($references,00006009070000);
array_push($references,00103000000008);
array_push($references,00103000000009);
array_push($references,00103000000010);
array_push($references,00103000000011);
array_push($references,00103000000012);
array_push($references,00103000000013);
array_push($references,00103000000014);
array_push($references,00103000000015);
array_push($references,00102000000006);
array_push($references,00102000000007);
array_push($references,00102000000008);
array_push($references,00102000000009);
array_push($references,00102000000010);
array_push($references,00102000000011);
array_push($references,00026000000350);
array_push($references,00026000000351);
array_push($references,00026000000352);
array_push($references,00026000000353);
array_push($references,00026000000354);
array_push($references,00026000000355);
array_push($references,00026000000356);
array_push($references,00026000000357);
array_push($references,00026000000358);
array_push($references,00026000000359);
array_push($references,00026000000360);
array_push($references,00026000000361);
array_push($references,00011008020000);
array_push($references,00011008020001);
array_push($references,00011008050000);
array_push($references,00011000000018);
array_push($references,00011009050000);
array_push($references,00011009050001);
array_push($references,00011000000019);
array_push($references,00011000000020);
array_push($references,00100000000009);
array_push($references,00100000000010);
array_push($references,00100000000011);
array_push($references,00100000000012);
array_push($references,00100000000013);
array_push($references,00100000000014);
array_push($references,00100000000015);
array_push($references,00100000000016);
array_push($references,00100000000017);
array_push($references,00101000000026);
array_push($references,00101000000027);
array_push($references,00008000000005);
array_push($references,00008000000006);
array_push($references,00008000000007);
array_push($references,00008000000008);
array_push($references,00008000000009);
array_push($references,00008000000010);
array_push($references,00008000000011);
array_push($references,00008000000012);
array_push($references,00008000000013);
array_push($references,00009001000000);
array_push($references,00009001000013);
array_push($references,00009000000000);
array_push($references,00009000000001);
array_push($references,00009001000038);
array_push($references,00009001000007);
array_push($references,00009000000002);
array_push($references,00009000000003);
array_push($references,00009000000004);
array_push($references,00009001000021);
array_push($references,00009001000022);
array_push($references,00009000000005);
array_push($references,00009000000006);
array_push($references,00009000000007);
array_push($references,00009000000008);
array_push($references,00009017000002);
array_push($references,00009000000009);
array_push($references,00009000000010);
array_push($references,00009001010002);
array_push($references,00009001000005);
array_push($references,00009013000001);
array_push($references,00009013000002);
array_push($references,00009013000003);
array_push($references,00009000000011);
array_push($references,00009000000012);
array_push($references,00009000000013);
array_push($references,00009000000014);
array_push($references,00009000000015);
array_push($references,00009001000016);
array_push($references,00009001000017);
array_push($references,00009001000018);
array_push($references,00009001000019);
array_push($references,00009001000020);
array_push($references,00026057000003);
array_push($references,00026057000004);
array_push($references,00026000000370);
array_push($references,00026057000008);
array_push($references,00026057000007);
array_push($references,00006002010000);
array_push($references,00006002020000);
array_push($references,00006002030000);
array_push($references,00006002040000);
array_push($references,00006003010000);
array_push($references,00006003030000);
array_push($references,00006003040000);
array_push($references,00006000000005);
array_push($references,00006000000006);
array_push($references,00006000000007);
array_push($references,00006000000008);
array_push($references,00089002000007);
array_push($references,00089002000010);
array_push($references,00089002000006);
array_push($references,00089002000009);
array_push($references,00089002000008);
array_push($references,00026001000018);
array_push($references,00026001000019);
array_push($references,00009001000027);
array_push($references,00009001000028);
array_push($references,00009001000029);
array_push($references,00009001000030);
array_push($references,00009001000031);
array_push($references,00009001000032);
array_push($references,00009001000033);
array_push($references,00009001000034);
array_push($references,00009001000035);
array_push($references,00009001000036);
array_push($references,00009001000037);
array_push($references,00026000000715);
array_push($references,00026000000699);
array_push($references,00026000000697);
array_push($references,00026000000701);
array_push($references,00026000000689);
array_push($references,00026000000690);
array_push($references,00026000000707);
array_push($references,00026000000691);
array_push($references,00026000000723);
array_push($references,00026000000785);
array_push($references,00026000000789);
array_push($references,00026000000695);
array_push($references,00026000000698);
array_push($references,00026000000712);
array_push($references,00026000000705);
array_push($references,00026000000703);
array_push($references,00026000000700);
array_push($references,00026000000724);
array_push($references,00026000000733);
array_push($references,00026000000750);
array_push($references,00026000000738);
array_push($references,00026000000735);
array_push($references,00026000000739);
array_push($references,00026000000734);
array_push($references,00026000000741);
array_push($references,00026000000740);
array_push($references,00026000000751);
array_push($references,00026000000746);
array_push($references,00026000000752);
array_push($references,00026000000736);
array_push($references,00026000000744);
array_push($references,00026000000743);
array_push($references,00026000000753);
array_push($references,00026000000749);
array_push($references,00026000000754);
array_push($references,00026000000732);
array_push($references,00026000000725);
array_push($references,00026000000716);
array_push($references,00026000000710);
array_push($references,00026000000709);
array_push($references,00026000000726);
array_push($references,00026000000692);
array_push($references,00026000000718);
array_push($references,00026000000727);
array_push($references,00026000000693);
array_push($references,00026000000708);
array_push($references,00026000000702);
array_push($references,00026000000696);
array_push($references,00026000000706);
array_push($references,00026000000728);
array_push($references,00026000000729);
array_push($references,00026000000714);
array_push($references,00026000000711);
array_push($references,00026000000730);
array_push($references,00026000000748);
array_push($references,00026000000755);
array_push($references,00026000000745);
array_push($references,00026000000737);
array_push($references,00026000000756);
array_push($references,00026000000742);
array_push($references,00026000000747);
array_push($references,00026000000757);
array_push($references,00026000000758);
array_push($references,00026000000717);
array_push($references,00026000000731);
array_push($references,00026000000704);
array_push($references,00026000000719);
array_push($references,00026000000722);
array_push($references,00026000000721);
array_push($references,00026000000720);
array_push($references,00026000000713);
array_push($references,00026000000693);
array_push($references,00026000000764);
array_push($references,00026000000765);
array_push($references,00026000000761);
array_push($references,00026000000766);
array_push($references,00026000000760);
array_push($references,00026000000759);
array_push($references,00026000000762);
array_push($references,00026000000763);
array_push($references,00026000000767);
array_push($references,00026000000548);
array_push($references,00026000000549);
array_push($references,00026000000534);
array_push($references,00026000000535);
array_push($references,00026000000532);
array_push($references,00026000000533);
array_push($references,00026000000538);
array_push($references,00026000000539);
array_push($references,00026000000536);
array_push($references,00026000000537);
array_push($references,00026000000542);
array_push($references,00026000000543);
array_push($references,00026000000540);
array_push($references,00026000000541);
array_push($references,00026000000546);
array_push($references,00026000000547);
array_push($references,00026000000544);
array_push($references,00026000000545);
array_push($references,00026000000514);
array_push($references,00026000000517);
array_push($references,00026000000513);
array_push($references,00026000000516);
array_push($references,00026000000512);
array_push($references,00026000000515);
array_push($references,00026000000800);
array_push($references,00026000000801);
array_push($references,00026000000802);
array_push($references,00026000000803);
array_push($references,00026000000804);
array_push($references,00026000000805);
array_push($references,00026000000806);
array_push($references,00026000000807);
array_push($references,00026000000808);
array_push($references,00026000000809);
array_push($references,00026000000810);
array_push($references,00026000000811);



/*
foreach ($references as $reference) {
	$que="SELECT `id_product`,0 as combi, reference FROM `ps_product` WHERE `reference` LIKE '%".$reference."' UNION SELECT `id_product`,`id_product_attribute`,`reference` FROM `ps_product_attribute` WHERE `reference` LIKE '%".$reference."'";
	$query2 = $mydb->get_results( $que, OBJECT );
	foreach ($query2 as $row2) {
		echo "<p>Match ".$reference." con ".$row2->id_product."</p>";
		$que="SELECT * from ps_image a left join ps_image_lang b on a.id_image=b.id_image and b.id_lang=1 where id_product='".$row2->id_product."'";
		$query3 = $mydb->get_results( $que, OBJECT );
		foreach ($query3 as $row3) {
			$row3->url="http://promosillas.com/tiendaonline/img/p/".implode('/',str_split($row3->id_image))."/".$row3->id_image.".jpg";
			print_r($row3);
		};
	};
}
*/


foreach ($references as $reference) {
	$que="SELECT `id_product`,0 as combi, reference FROM `ps_product` WHERE `reference` LIKE '%".$reference."' UNION SELECT `id_product`,`id_product_attribute`,`reference` FROM `ps_product_attribute` WHERE `reference` LIKE '%".$reference."'";
	$query2 = $mydb->get_results( $que, OBJECT );
	foreach ($query2 as $row2) {
		echo "<p>Match ".$reference." con ".$row2->id_product."</p>";
		$que="SELECT * from ps_image a left join ps_image_lang b on a.id_image=b.id_image and b.id_lang=1 where id_product='".$row2->id_product."'";
		$query3 = $mydb->get_results( $que, OBJECT );
		foreach ($query3 as $row3) {
			$row3->url="http://promosillas.com/tiendaonline/img/p/".implode('/',str_split($row3->id_image))."/".$row3->id_image.".jpg";
			print_r($row3);
		};
	};
}
